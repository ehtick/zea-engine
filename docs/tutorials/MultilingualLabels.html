<!DOCTYPE html>
<html>
  <head>
    <title>Zea Engine - Labels</title>
    <meta charset="UTF-8"/>
    <style type="text/css">
      html, body {
        overflow: hidden;
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div id="viewport"></div>
    </a>
  </body>
  <script type="module">

import { 
  Vec3,
  Xfo,
  Color,
  AssetItem,
  TreeItem,
  Material,
  BillboardItem,
  Label,
  labelManager,
  Scene,
  GLRenderer 
} from "https://unpkg.com/@zeainc/zea-engine/dist/index.esm.js"

console.log(labelManager)
const domElement = document.getElementById("viewport");

const scene = new Scene();
scene.setupGrid(20, 10);

const asset = new TreeItem('labels');

fetch("data/LabelPack.labels")
  .then(response => response.json())
  .then(data => {
    labelManager.loadLibrary('LabelPack', data)
    addLabel(new Vec3(0, 0, 0), new Vec3(0, 0.05, 0.08), new Color(1, 1, 0), "MyCustomLabel");
  });


let index = 0;
const addLabel = (lineEndPos, pos, color, name)=> {
  const label = new Label(name, 'LabelPack');
  label.getParameter('FontSize').setValue(48);
  label.getParameter('FontColor').setValue(color);
  label.getParameter('BackgroundColor').setValue(new Color(0.3, 0.3, 0.3));
  
  const billboard = new BillboardItem('billboard'+index, label);
  const xfo = new Xfo(pos);
  billboard.setLocalXfo(xfo);
  billboard.getParameter('PixelsPerMeter').setValue(300);
  billboard.getParameter('AlignedToCamera').setValue(true);
  billboard.getParameter('Alpha').setValue(1);
  // billboard.getParameter('lineEnd').addElement(lineEndPos);
  // billboard.getChildByName('line0').getMaterial().getParameter('Color').setValue(new Color(.7, .7, .7));
  asset.addChild(billboard);

  index++;
}

scene.getRoot().addChild(asset);

const renderer = new GLRenderer(domElement);
renderer.getViewport().getCamera().setPositionAndTarget(new Vec3(5, 6, 3), new Vec3(0, 0, 0));
renderer.setScene(scene);
renderer.resumeDrawing();

  </script>
</html>